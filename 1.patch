diff --git a/SafetyMonitorView/Forms/MainForm.cs b/SafetyMonitorView/Forms/MainForm.cs
index 1b8e9b259643f0379f0e3c9a5981c5308d2ae0a8..f24b6a8ad192ec26dbeaf37fecbb1a8f4cb57339 100644
--- a/SafetyMonitorView/Forms/MainForm.cs
+++ b/SafetyMonitorView/Forms/MainForm.cs
@@ -47,50 +47,51 @@ public class MainForm : MaterialForm {
         _skinManager = MaterialSkinManager.Instance;
         _skinManager.AddFormToManage(this);
 
         _dashboardService = new DashboardService();
         _appSettingsService = new AppSettingsService();
 
         // Load settings BEFORE initializing UI
         _appSettings = _appSettingsService.LoadSettings();
         if (_appSettings.ChartPeriodPresets == null || _appSettings.ChartPeriodPresets.Count == 0) {
             _appSettings.ChartPeriodPresets = ChartPeriodPresetStore.CreateDefaultPresets();
         }
         ChartPeriodPresetStore.SetPresets(_appSettings.ChartPeriodPresets);
 
 
         // Apply theme from settings
         _skinManager.Theme = _appSettings.IsDarkTheme
             ? MaterialSkinManager.Themes.DARK
             : MaterialSkinManager.Themes.LIGHT;
 
         _skinManager.ColorScheme = new ColorScheme(
             Primary.Teal700, Primary.Teal900, Primary.Teal500,
             Accent.Teal200, TextShade.WHITE
         );
 
         _dataService = new DataService(_appSettings.StoragePath);
+        AttachDataServiceHandlers();
 
         // Set default font for the form
         Font = new Font("Roboto", 9f, FontStyle.Regular);
 
         InitializeComponent();
         ApplyWindowSettings();
         LoadDashboards();
         UpdateStatusBar();
         SetupRefreshTimer();
 
         _isLoading = false;  // ДОБАВЛЕНО: загрузка завершена
     }
 
     #endregion Public Constructors
 
     #region Protected Methods
 
     protected override void OnFormClosing(FormClosingEventArgs e) {
         if (!_isExitConfirmed && e.CloseReason == CloseReason.UserClosing) {
             var confirmExit = ThemedMessageBox.Show(
                 this,
                 "Exit Safety Monitor?",
                 "Exit Confirmation",
                 MessageBoxButtons.YesNo,
                 MessageBoxIcon.Question
@@ -553,81 +554,112 @@ public class MainForm : MaterialForm {
         _themeTimer.Tick += (s, e) => {
             _themeTimer!.Stop();
             _themeTimer.Dispose();
             _themeTimer = null;
             UpdateDashboardContainerTheme();
             UpdateQuickAccessPanelTheme();
             UpdateMenuTheme();
             _dashboardPanel?.UpdateTheme();
         };
         _themeTimer.Start();
     }
 
     private void SetTheme(MaterialSkinManager.Themes theme) {
         _skinManager.Theme = theme;
         // MaterialSkinManager queues multiple deferred color updates.
         // A timer guarantees we reapply our colors AFTER MSM is fully done.
         ScheduleThemeReapply();
     }
 
     private void SetupRefreshTimer() {
         _refreshTimer = new System.Windows.Forms.Timer { Interval = _appSettings.RefreshInterval * 1000 };
         _refreshTimer.Tick += (s, e) => _dashboardPanel?.RefreshData();
         _refreshTimer.Start();
     }
 
+    private void AttachDataServiceHandlers() {
+        _dataService.ConnectionFailed += OnDataServiceConnectionFailed;
+    }
+
+    private void OnDataServiceConnectionFailed(string details) {
+        if (InvokeRequired) {
+            BeginInvoke(() => OnDataServiceConnectionFailed(details));
+            return;
+        }
+
+        _refreshTimer?.Stop();
+        _statusLabel.Text = "SQL connection failed";
+
+        var message = "Не удалось подключиться к SQL серверу. Получение данных остановлено. Приложение будет закрыто."
+            + Environment.NewLine
+            + Environment.NewLine
+            + details;
+
+        ThemedMessageBox.Show(
+            this,
+            message,
+            "Ошибка подключения",
+            MessageBoxButtons.OK,
+            MessageBoxIcon.Error
+        );
+
+        _isExitConfirmed = true;
+        Close();
+    }
+
     private void ShowAbout() {
         ThemedMessageBox.Show(this, "SafetyMonitorView v1.0\n\nSafety Monitor Dashboard\nFor ASCOM Alpaca devices\n\n© 2026",
             "About SafetyMonitorView", MessageBoxButtons.OK, MessageBoxIcon.Information);
     }
 
     private void ShowColorSchemeEditor() {
         using var editor = new ColorSchemeEditorForm();
         editor.ShowDialog(this);
     }
 
     private void ShowChartPeriodPresetEditor() {
         using var editor = new ChartPeriodPresetEditorForm(_appSettings.ChartPeriodPresets);
         if (editor.ShowDialog(this) == DialogResult.OK) {
             _appSettings.ChartPeriodPresets = editor.Presets;
             _appSettingsService.SaveSettings(_appSettings);
             ChartPeriodPresetStore.SetPresets(_appSettings.ChartPeriodPresets);
 
             if (_currentDashboard != null) {
                 LoadDashboard(_currentDashboard);
             }
         }
     }
 
     private void ShowSettings() {
         using var settingsForm = new SettingsForm(_appSettings.StoragePath, _appSettings.RefreshInterval);
         if (settingsForm.ShowDialog() == DialogResult.OK) {
             _appSettings.StoragePath = settingsForm.StoragePath;
             _appSettings.RefreshInterval = settingsForm.RefreshInterval;
             _appSettingsService.SaveSettings(_appSettings);
 
             _dataService = new DataService(_appSettings.StoragePath);
+            AttachDataServiceHandlers();
             UpdateStatusBar();
 
             _refreshTimer?.Interval = _appSettings.RefreshInterval * 1000;
 
             if (_currentDashboard != null) {
                 LoadDashboard(_currentDashboard);
             }
         }
     }
 
     private void UpdateDashboardContainerTheme() {
         _dashboardContainer.BackColor = _skinManager.Theme == MaterialSkinManager.Themes.LIGHT
             ? Color.FromArgb(250, 250, 250)
             : Color.FromArgb(25, 36, 40);
     }
 
     private void UpdateDashboardMenu(ToolStripMenuItem dashboardMenu) {
         dashboardMenu.DropDownItems.Clear();
 
         var isLight = _skinManager.Theme == MaterialSkinManager.Themes.LIGHT;
         var iconColor = isLight ? Color.Black : Color.White;
 
         // Dashboard list items - without icons
         foreach (var dashboard in _dashboards) {
             var item = new ToolStripMenuItem(dashboard.Name) {
